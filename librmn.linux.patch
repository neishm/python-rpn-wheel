diff --git a/Makefile b/Makefile
index fb4d0fb..83d50dd 100644
--- a/Makefile
+++ b/Makefile
@@ -24,7 +24,7 @@ genlib:
 	./merge_rmnlib_packages $(WORKDIR) $(LIBDIR) $(LIBNAME)_d ; \
 	else \
 	./make_locallib_packages ; \
-	rm -f $(LIBDIR)/$(EC_ARCH)/$(LIBNAME).a ; \
+	rm -f $(LIBDIR)/$(EC_ARCH)/$(LIBNAME)*.a ; \
 	./merge_rmnlib_packages $(WORKDIR) $(LIBDIR) $(LIBNAME) ; \
 	fi
 
diff --git a/base/Makefile b/base/Makefile
index bb26828..68ea9a7 100644
--- a/base/Makefile
+++ b/base/Makefile
@@ -105,7 +105,7 @@ grgg.o:		grgg.F 	kases.cdk 	pi.cdk
 idxes.o:	idxes.F 	kases.cdk 
 llfxy.o:	llfxy.F 	pi.cdk 
 mxma.o:         mxma.F
-	s.compile -O 1 -defines "=$(DEFINE)" -optf "=$(FFLAGS)" $(SUPP_OPT) $(FTN_SUPP_OPT) -src $<
+mxma.o: OPTIMIZ = 1
 
 mzonxst.o:	mzonxst.F 
 npspin.o:       npspin.F 	kases.cdk 	pi.cdk 
diff --git a/fstd98/fstd98.c b/fstd98/fstd98.c
index ec832d6..d209d01 100644
--- a/fstd98/fstd98.c
+++ b/fstd98/fstd98.c
@@ -589,7 +589,7 @@ int c_fstecr(word *field_in, void * work, int npak,
   nw = W64TOWD(nw);
   
   keys_len = W64TOWD((f->primary_len + f->info_len));
-  buffer = (buffer_interface_ptr) alloca((10+keys_len+nw+128)*sizeof(word));
+  buffer = (buffer_interface_ptr) malloc((10+keys_len+nw+128)*sizeof(word));
   if (buffer) 
     memset(buffer,0,(10+keys_len+nw+128)*sizeof(word));
   else {
@@ -946,7 +946,7 @@ fprintf(stderr,"NEW PACK CODE======================================\n");
     sprintf(string,"Write(%d)",iun);
     print_std_parms(stdf_entry,string,prnt_options,0);
   }
-/*  free(buffer);        remplaced by alloca */
+  free(buffer);
   xdf_double = 0;
   xdf_short = 0;
   xdf_byte = 0;
@@ -1813,7 +1813,7 @@ int c_fstluk(word *field, int handle, int *ni, int *nj, int *nk)
     
 /*  printf("Debug+ fstluk lng2 = %d\n",lng2); */
   /* allocate 8 more bytes in case of realingment for 64 bit data */
-  if ((work_field = alloca(8+(lng2+10)*sizeof(word))) == NULL) {
+  if ((work_field = malloc(8+(lng2+10)*sizeof(word))) == NULL) {
     sprintf(errmsg,"memory is full, was trying to allocate %ld bytes",
             lng*sizeof(word));
     return(error_msg("c_fstluk",ERR_MEM_FULL,ERRFATAL));
@@ -2049,7 +2049,7 @@ fprintf(stderr,"NEW UNPACK CODE ======================================\n");
     DecodeMissingValue( field , (*ni)*(*nj)*(*nk) , xdf_datatyp&0x3F,xdf_byte,xdf_short,xdf_double ); /* */
   }
   free(stdf_entry);
-/* free(work_field);        replaced by alloca */
+  free(work_field);
   xdf_double = 0;
   xdf_short = 0;
   xdf_byte = 0;
diff --git a/interp/Makefile b/interp/Makefile
index 893c1df..f4d854f 100644
--- a/interp/Makefile
+++ b/interp/Makefile
@@ -1,6 +1,6 @@
 .SUFFIXES :
 
-.SUFFIXES : .ftn90 .c .o .a
+.SUFFIXES : .ftn90 .c .o .a .f90
 
 SHELL = /bin/bash
 
diff --git a/make_locallib_packages b/make_locallib_packages
index 271ed66..9aad400 100755
--- a/make_locallib_packages
+++ b/make_locallib_packages
@@ -1,12 +1,13 @@
 #!/bin/bash
 # set -x
+set -e
 mmake=make
 which gmake >/dev/null  && mmake=gmake
 echo mmake = $mmake
 #workdir=`pwd`
 if [[  ${CRAYOS_VERSION} == "" ]]; then
 echo "================== Normal mode ======="
-for package in base burp98_f cmc_log compresseur fstd98 interp interpv lamineur packers primitives readlx bmf spectral twinbuffer template_utils/gmm template_utils/whiteboard
+for package in base burp98_f cmc_log compresseur fstd98 interp interpv lamineur packers primitives readlx bmf spectral twinbuffer
 do 
   pushd ${package}
   $mmake locallib
diff --git a/merge_rmnlib_packages b/merge_rmnlib_packages
index 424b8b6..6efbdc6 100755
--- a/merge_rmnlib_packages
+++ b/merge_rmnlib_packages
@@ -1,12 +1,14 @@
-# set -x
+#!/bin/bash
+set -e
 srcd=`pwd`
 workdir=$1
 libdir=$2
 libname=$3
 cd ${workdir}
-for package in ${srcd}/base ${srcd}/burp98_f ${srcd}/cmc_log ${srcd}/compresseur ${srcd}/fstd98 ${srcd}/interp ${srcd}/interpv ${srcd}/lamineur ${srcd}/packers ${srcd}/primitives ${srcd}/readlx ${srcd}/bmf ${srcd}/spectral ${srcd}/twinbuffer ${srcd}/template_utils/gmm ${srcd}/template_utils/whiteboard
+for package in ${srcd}/base ${srcd}/burp98_f ${srcd}/cmc_log ${srcd}/compresseur ${srcd}/fstd98 ${srcd}/interp ${srcd}/interpv ${srcd}/lamineur ${srcd}/packers ${srcd}/primitives ${srcd}/readlx ${srcd}/bmf ${srcd}/spectral ${srcd}/twinbuffer
 do 
   ar x ${package}/${EC_ARCH}/lib_local.a
-  ar rcv ${libdir}/${EC_ARCH}/${libname}.a *.o
+  ar rcv ${libdir}/${EC_ARCH}/${libname}_tmp.a *.o
   rm *.o
 done
+mv ${libdir}/${EC_ARCH}/${libname}_tmp.a ${libdir}/${EC_ARCH}/${libname}.a
diff --git a/primitives/Makefile b/primitives/Makefile
index 67815f3..fdbb6f9 100644
--- a/primitives/Makefile
+++ b/primitives/Makefile
@@ -39,7 +39,7 @@ TARRLS = beta
 default: obj
 
 rmnlib_v:
-	-rm rmnlib_version.f
+	-rm -f rmnlib_version.f
 	./rmnlib_version $(RMNLIB_VERSION)
 
 rmnlib_version.f: rmnlib_v
